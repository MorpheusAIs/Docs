![Image1forYellowstone](https://github.com/MorpheusAIs/Morpheus/assets/1563345/80a6c1cf-fe52-42ba-bfd4-91d9faf67f07)

# Morpheus “Yellowstone” 계산 모델
### Erik Voorhees
### 2024 1월 03일

탈중앙화 AI 네트워크에서 컴퓨팅 인센티브를 위한 Morpheus 토크노믹스 구조에 대한 제안된 개정안.   
Notion에서 확인하기: https://defiant-wolfsbane-830.notion.site/Morpheus-Yellowstone-Compute-Model-2ca9b4e7e1374c898937fdbd1b964cc1


## 개요
Yellowstone 컴퓨팅 모델에서 Morpheus 네트워크는 경쟁입찰 프로세스를 통하여 실제로 제공된 컴퓨팅에 대해서만 공급자에게 비용을 지불합니다. 부족한 IPS(추론/초) 생산량을 지불이 아닌 잔액에 따라 MOR 토큰 보유자에게 비례적으로 할당합니다. 이를 통해 사용자의 취약성을 최소화 하면서 UX를 큰폭으로 개선합니다. 또한 Yellowstone은 시간이라는 중요한 지표와 합격/불합격 테스트를 통해 공급자가 적절하고 신속하고 정확한지를 확인합니다. Yellowstone은 라우터를 통하여 프롬프트나 결과를 전송하지 않음으로 개인정보를 보호하며 대규모 운영을 가능하게 하기 위하여 트랜잭션을 최소화 합니다. 이 모델을 통하여 MOR은 추론 당 트랜젝션을 필요로 하지 않은 상태에서 허가없는 컴퓨팅에 대한 영구적(무제한은 아님)액세스를 가능하게 함으로 근본 가치를 실현합니다.

만약 이 백서가 채택된다면,[Morpheus 백서]의 "증명,등록 및 보상" 부분을 대체합니다. (https://github.com/MorpheusAIs/Docs/blob/main/!KEYDOCS%20README%20FIRST!/WhitePaper.md)

## 배경 정보
Morpheus는 무허가 탈중앙화AI를 만들기 위한 수단으로 충분한 컴퓨팅 파워를 제공합니다. 이것을 인센티브화 하기 위해 토크노믹스를 활용합니다. 초기 Morpheus의 구상에 따르면 Morpheus 는 MOR 의 발행량중 24%를 추론 요청을 받은 컴퓨팅 파워 공급자에게 할당 했으며, 이는 요청자가 보유한 MOR 보유량에 따라 추론 요청의 우선순위를 정했습니다.

### 원본 백서에서 발췌:
`“각 컴퓨팅 공급자가 소각한 일정 비율의MOR 거래 수수료는 해당 컴퓨팅 제공자의 컴퓨팅 증명 역할을 하며 매일 소각한 MOR 토큰의 일정 비율을 획득 합니다" 라고 설명합니다.`
`예시로, 네트워크 시작 1일차에 컴퓨팅 공급자가 100명이라고 한다면, 각각의 컴퓨팅 공급자는 수수료로 소각된 MOR을 비례 배분 보상 받습니다. 이 경우에 각각의 100개의 컴퓨팅 제공자가 100MOR을 소각했다고 가정한다면, 매일 3,456MOR 중 1%인 34.56MOR을 받게 됩니다.”`

### 이 방식에는 3가지 주요 문제점이 있습니다:
1) 이 방법은 사용자들에게 추론당 거래수수료를 지불하게 합니다. 만약 이것이 낮다고 해도 상당한 마찰을 야기하며 OpenAI의 UX에 대한 열등함을 발생시킬 수 있습니다. 또한 추론당 최소 하나의 블록체인 트랜잭션이 필요한데, 이것은 아마 L2에서조차 확장성을 유지하기 어려울 것입니다. 각 추론당 발생 비용은 매우 낮으며 블록체인 트랜잭션이 필요하다면 경제적으로 실현이 불가능할 것입니다. 
2) 이 모델은 대체로 심각하게 악용 될 가능성이 있으며 컴퓨팅 제공자의 예상 수익이 실제 컴퓨팅 비용보다 훨씬 높습니다. 따라서 악의적 사용자는 자신이 유지하고 있는 컴퓨팅 공급 노드에 스팸 추론 요청을 대량으로 보내 누구에게도 경제적 가치가 제공되지 않았음에도 매일 상대적으로 많은 MOR토큰을 획들 할 수 있습니다. 이는 대규모의 초기(미사용) 컴퓨팅으로 이어질 수 있으며 큰규모의 수익 기회가 사라지면 소멸되지만 초기 보조금에 사용된 MOR은 낭비되거나 손실될 것입니다.
3) 만약 추론 요청이 공급자가 보유한 MOR에 따라 우선순위가 정해진다면 공급자의 성능(응답 시간)과 추론 비용은 네트워크에서 무시됩니다. 그러나 네트워크가 최적화해야 할 것은 바로 이 두가지 요소입니다(응답 시간과 컴퓨팅 비용은 가능한 낮게 유지하는것이 이상적임). 만약 MOR을 가장 많이 보유한 공급자가 대학 시절 사용하던 $200짜리 GPU를 사용한다면, 많은 사용자의 추론 성능은 극도로 저하될 것입니다. 우선순위는 입찰 가격과 성능에 따라 결정되어야 합니다. MOR 보유량이 아닙니다.

아래에는 위에 언급된 문제를 해결하기 위해 Morpheus 토크노믹스를 수정한 “Yellowstone” 모델을 제안합니다. 이 모델은 컴퓨팅에 할당된 배출량의 비율에 관계없이 작동하며, 총 배출량의 24%가 지금 상태로 유지된다고 가정합니다.

### 목표:
1) 사용자에게 추론당 비용을 지불하지 않도록 선택권을 부여합니다(이상적으로 전혀 지불하지 않는게 좋습니다).
2) 효율을 높이고, 확장 가능하며 지속 가능한 권한 없는 컴퓨팅 자원 제공을 위해 지나치게 높은 가격을 지불하지 않도록 합니다.
3) 컴퓨팅 공급자 간의 낮은 응답 시간과 비용 경쟁을 인센티브화 합니다.
4) 블록체인 트랜잭션 수의 최소화를 합니다.(L2 또는 그 외의 것)
5) MOR에 대한 경제적으로 건전한 기본 수요를 입증합니다. 

## Yellowstone 모델
4가지 관련 구성 요소:

### 사용자(user)
* 질문을 가지고 있음
* 검열/감시 없는 빠르고 정확한 컴퓨팅을 무료로 원합니다.

### 공급자(provider)
* 컴퓨팅을 가지고 있음
* 수익을 원함 (MOR)

### 라우터(router) 
* 고성능 처리 엔진
* 탈중앙화

### 컴퓨팅 계약
* 비허가형 스마트컨트랙트는 MOR의 배출량을 수신 하며, 공급자의 입출금 내역을 추적하고 요청시 공급자에게 지불합니다.

## 표준 도량형

AI에는 추론/초(IPS)로 측정되는 추론의 기본 단위가 있습니다. 이는 개념적으로 블록체인에서의 wei와 비교할 수 있습니다. 추론은 Yellowstone 라우터에서 요금 산정에 사용됩니다. 따라서 단일 유닛 Morpheus AI 의 최소 단위계는 추론입니다. 요청에 따라 이는 모든 컴퓨팅 작업에 적용될 수 있습니다.  

AI와 블록체인이 공통점을 병합함에 따라 Morpheus는 AI와 블록체인 모두에서 사용되는 용어를 명확히 하기 위해 오픈소스 측정 표준을 제공하고자 합니다.


모델이 생성하는 응답 크기에 따른 두가지 유형의 프롬프트:  

**결정론적 프롬프트**, 응답 길이를 고려하는 경우. 응답 예시:
- 채팅/이미지 생성
- 질병 진단
- 사물 인식
- 사기 탐지


**비결정론적 프롬프트** 응답 길이를 고려하지 않는 경우. 응답 예시:
- 스파게티에 대한 소나타 작곡
- 생일 축하 동영상 제작
- 모델 X와 Y 결합
- 3D 모델을 .stl 파일로 변환

Yellowstone은 길이가 결정된(결정론적) 프롬프트에 중점을 맞춥니다. 설명된 라우터는 미래에 비결정론적 프롬프트를 처리하는 방식으로 구축될 것 입니다, 현재는 해당 서비스가 제공되지 않습니다. 이를 위해 분산형 AI의 표준화된 측정을 사용합니다.

## DeAI 요금

### 추론/초의 표현식:

|  유형  |   응답   |  비용 |
|--------------------------|
| 결정 | 언어 | 추론 토큰 per 초 (TPS)|
| 미결정 - 미디어 | 오디오 | 추론 프레임 per 초 (ISPS) |
| 미결정 - 미디어 | 비디오 | 추론 프레임 per 초 (IFPS) |
| 미결정 - 미래 기술 | 알 수 없는 미래의 형식 | N/A |

최초의 Yellowstone 라우터의 추론 측정 단위는 TPS 입니다. 다른 추론 형식은 이를 따릅니다.

### 시간

추론 블록 시간은 12초이며, 이는 추론 트랜잭션 블록이 1분에 5번씩 게시되고 설명된다는 의미입니다.

## 정의

**“사용자”**: MOR주소를 보유하며 컴퓨터을 사용하여 라우터에 요청을 보내는 모든 개체로 정의됩니다. 이것은 Morpheus 데스크톱 노드에서 요청을 보내는 개인,봇, 또는 최종 사용자를 대신하여 Morpheus 네트워크와 상호 작용 하는 회사 또는 제3의 웹사이트일 수도 있습니다.(최종 사용자의 추론 사용량은 추론 실패 시 제외되며 컴퓨팅 계약에서 추적 또는 고려되지 않습니다.)
**“공급자”**: MOR주소를 보유하며 컴퓨팅 리소스를 제공하고 라우터를 통해 IPS 입찰을 제안하며 노드를 실행하는 모든 개체로 정의됩니다. 공급자가 라우터의 입찰에 성공하면 사용자에게 다양한 AI 모델을 위한 컴퓨팅 자원(GPU 등)을 제공합니다.

**“라우터”**: MOR주소를 보유하며 사용자와 공급자간의 양측 간 시장을 조율하는 소프트웨어 애플리케이션으로 정의됩니다. 라우터는 공급자 주소와 입찰을 등록 및 추적, 사용자의 요청을 처리, 처리된 요청의[milliseconds] 및 통과/실패 테스트 기록, 컴퓨팅 계약에 대한 적격 공급자에게 MOR을 지급하도록 지시합니다. 라우터는 MOR 트랜잭션(또는 블록체인 상 트랜잭션)을 받지거나 보내지 않습니다. 또한, 라우터는 요청의 내용이나 응답을 볼 수 없습니다.

**“컴퓨팅 계약”**: MOR주소를 보유하며 컴퓨팅 버킷에 할당된 모든 방출된 MOR을 받고, 적격 공급자에게 지급해야 할 금액을 추적하고, 공급자가 지급을 요청하면 적격 공급자에게 MOR을 지급하는 스마트 컨트랙트로 정의됩니다.

**"초당 추론" (IPS)**: AI 추론 최소 단위입니다. 추론은 Yellowstone 라우터에서 라우터에서 요금 산정에 사용됩니다. 따라서 단일 유닛 Morpheus AI 의 최소 단위계는 추론입니다.

**“최대IPS”**: 라우터 지불 승인에 허용되는 최대 IPS 수를 나타냅니다.

**“RFC”**: “컴퓨팅 요청”의 약어 입니다. 사용자는 라우터에 RFC를 보내고 사용자가 액세스 하고자 하는 [LLM]과 허용 가능 응답 IPS 상한선인 [IPSMax]를 지정합니다. 숫자가 높을수록 응답 대기 시간이 길어지며 일일 한도인 [UserMax] 에 가까워 지기 때문에 사용자는 이 값을 제한하려고 합니다. 

### 컨트랙트 보호

미사용 컴퓨팅을 사용하여 MOR 가격을 내리거나 조작하는것을 막기 위해 컴퓨팅 공급자에게 할당 된 사용하지 않는 MOR풀은 블록당 하루에 1% 이상 감소할 수 없습니다. 이는 일반적인 컴퓨팅 배출량의 +1%에 해당됩니다. 

### 컴퓨팅 부스트랩 인센티브

자본 계약 부스트래핑 기간 이후 첫 1년 동안 상위 100위 컴퓨팅 공급자는 MOR 수익의 2.4%를 비례 배분 받을 수 있습니다. 이는 라우터가 계산하고 컴퓨팅 계약에 반영됩니다.

## 작업흐름
1) 사용자, 공급자, 라우터는 모두 MOR 공개키를 생성합니다(이는 각자 신원이 되며, 모든 메시지는 해당키로 서명됨).
2) 사용자가 MOR을 보유 하고 있다면 사용자는 라우터에 서명된 컴퓨팅 요청 “RFC” 를 제출할 수 있습니다. 사용자는 [LLM] 과 [IPSMax]를 지정합니다.
3) 라우터는 사용자의 MOR 잔액에 따라 RFC 우선순위를 지정합니다.(시빌 공격 문제 해결)
4) 라우터는 [LLM]을 지원하는 공급자를 선택하며, MOR에서 IPS당 최저 입찰가를 기준으로 우선순위를 정합니다. 
5) 라우터가 활성 상태 확인을 공급자에게 전송합니다. 통과되면
6) 라우터는 사용자와 공급자를 연결합니다.
7) 사용자가 질문([LLM],[prompt]) 을 공급자에게 보냅니다. 
8) 공급자가 질문을 처리하며 결과를 사용자에게 보냅니다.
9) 사용자는 4단계와 5단계 사이의 시간에 전달된 [milliseconds] 그리고 [ISP] 에 대한 [Pass/Fail]을 보고합니다.
10) 라우터는 사용자가 보고한 [milliseconds] per [IPS] 가 해당 [LLM]에 대한 과거 Z쿼리의 평균보다 X%이상 나쁘지 않다고 [Pass] 보고를 받은 경우 공급자에게 MOR을 지급 하도록 컴퓨팅 계약에 지시합니다.
11) (잠시후) 공급자가 컴퓨팅 컨트랙트에 MOR을 지급 요청하고 컴퓨팅 컨트랙트가 유효한 경우 MOR을 지급 전송합니다(여기까지 블록체인 거래는 발생하지 않으며 첫 블록체인 TX 일괄 처리 가능).

![ComputeContractImage2](https://github.com/MorpheusAIs/Morpheus/assets/1563345/e66ea20c-9851-4f9e-9caa-66c6d798c462)

## 결과
* 사용자는 질문에 대한 빠른 결과를 얻고 비용을 지불하지 않았습니다.(이는 훌륭한 UX이며 채택으로 이어질 것입니다) **목표1 해결**
* 경쟁 입찰을 통해 컴퓨팅 비용을 지불하는 컴퓨팅 계약은 주문한 사용자로부터 품질/만족도를 확인 받습니다. **목표2 해결**
* 공급자는 응답이 충분히 빠른 경우 컴퓨팅 계약으로부터 돈(MOR)을 지급 받았습니다. 공급자는 컴퓨팅을 제공하기 위해 요청한 금액을 정확히 받았습니다. 만약 그의 요청이 너무 높으면 다른 공급자가 더 낮게 입찰할 것이므로 시스템은 효율적이며 공급자의 가격을 기본 전기 비용 수준으로 낮출 수 있습니다.  **목표3 해결**
* 온체인 트랜잭션 수를 최소화 했습니다(수천개의 질문이 하나의 온체인 TX 없이 처리 됩니다). **목표4 해결**
* 무료로 빠른 컴퓨팅 능력을 얻는것은 필요로 하는 사용자가 보유해야 하는 MOR 토큰의 수요를 증가시킵니다. **목표5 해결**
* 6단계와 7단계는 합법적 프라이버시를 제공합니다(질문은 라우터를 거치지 않으며 답변도 마찬가지 입니다). 공급자는 어느정도 랜덤하게 선택되며 IP주소 이외에는 사용자의 산원을 알 수 없습니다. 추후 TOR + FHE를 통해 더 나은 프라이버시를 달성할 수 있습니다.
* 컴퓨팅 컨트랙트 계약 내에서 MOR 잔액이 감소했습니다. 컨트랙트는 기간당 지불된 MOR<배출로부터 얻은 MOR 인 한 재정적 안전을 유지할 수 있습니다.
* 사용자가 자신의 UserMax를 초과하는 RFC를 보내면, 라우터가 요청을 거부합니다.

—-------------

## 컴퓨팅 예산
Morpheus네트워크는 주어진 기간(예: 매일)에 컴퓨팅에 얼마만큼의 MOR 토큰을 지출할 것인지 결정해야 합니다. 이를 컴퓨팅 예산이라고 합니다. 각 기간동안 컴퓨팅 컨트랙트는 최대 해당 금액까지 MOR을 사용할 수 있습니다. 이 숫자를 MOR 가격으로 곱하면 매일 컴퓨팅 자원을 구입하는 데 사용할 수 있는 예산이 정해집니다.
## AccessRate
Morpheus 네트워크는 “AccessRate” 개념을 통해 IPS생산의 부족한 자원을 할당합니다. 액세스 요율은 각 MOR 토큰이 하루에 액세스할 수 있는 IPS의 수를 결정합니다. 사용하지 않는 액세스는 누적되지 않습니다. AccessRate은 언제나 1MOR 당 IPS 수량으로 표기됩니다(예: 1MOR=15,000IPS).AccessRate은 MaxIPS에 의해 부분적으로 결정되며 이는 네트워크가 하루에 구매할 수 있는 최대 IPS 수를 정량화 합니다

**AccessRate** = (1/MOR supply) * MaxIPS   
**MaxIPS** = ((MOR Compute Budget * MOR Price) / IPS Price) * 1000  
**UserMax** = AccessRate * User MOR balance

### 예시 가정: 
**MOR Supply** = 10,000,000 MOR tokens  
**MOR Compute Budget** = 3,000 MOR tokens per day  
**MOR Price** = $20  
**IPS Price** = $0.002 per 1000 IPS  
**User Balance** = 5 MOR tokens

### 예시 결과:
**MaxIPS** = 30,000,000,000 IPS (네트워크가 매일 구매/생산 가능한 최대 IPS)  
**AccessRate** = 3,000 (따라서 개별 MOR토큰은 하루에 3,000개의 IPS에 대한 액세스권한을 부여)
**UserMax** = 15,000 (5개의 MOR토큰을 보유한 사용자는 하루최대 15,000IPS에 액세스)


- 각 기간(매일), Morpheus 네트워크는 컴퓨팅 공급 업체로부터 X개의 IPS를 구매할 수 있는 충분한 자금을 보유하고 있습니다. X는 컴퓨팅 계약이 지출하고자 하는 MOR금액(“컴퓨팅 예산”)에 현재 MOR 가격을 곱한 값을 시장 IPS 가격으로 나눈 값입니다.
- 만약 컴퓨팅 예산이 3,000MOR이고 MOR가치가 $20인 경우 네트워크는 당일 최대 $60,000 의 IPS를 구매(생산)할 수 있습니다. 1,000IPS당 시장 가격이 $0.002라면 네트워크는 최대 300억개의 IPS를 구매할 수 있습니다(3000만 * 1000IPS)
- 잠재적으로 생성될 수 있는 300억 IPS의 생산량은 MOR 잔액에 따라 비례로 할당됩니다. 10,000,000개의 MOR이 있다고 가정합니다. 500MOR 토큰(총 0.005%)을 보유한  사용자는 당일 최대 150만 IPS에 자유롭게 액세스할 수 있습니다. 
- 컴퓨팅 예산이 배출량 이하로 유지되는 한 컴퓨팅 컨트랙트는 MOR이 부족할 수 없습니다.
- 실제로 대부분의 MOR토큰은 지갑과 거래소에 보관되며 일부만 IPS 생산을 요구하는데 사용됩니다.

## 참고사항
* MOR의 펀더맨털 수요는 Morpheus 네트워크에서 생성형AI및 기타 형태의 컴퓨팅에 액세스 하려고 하는 사용자들로부터 발생됩니다.
 
* 공급자의 하드웨어 유형은 사용자의 통과/실패 테스트를 충족하는 한 네트워크와 무관합니다. 효율적으로 처리 가능한 질문 수보다 많은 질문에 입찰하는 모든 공급자는 이 테스트에 불합격하여 패널티를 받게 됩니다.

* 위 모델의 중요한 점은 공급자의 컴퓨팅에 대한 수요가 있을때에만 비용을 지불한다는 것 입니다. 이를 통하여 네트워크가 필요하지 않을 때에도 대량의 MOR 토큰이 조기 배출되는 상황을 방지합니다 

* 공급자는 자신의 키로 보유한 LLM모델 해시에 서명하여 LLM을 가지고 있다는 것을 증명해야 합니다. 이것은 사용했다는 것을 증명하지는 못하지만 다운로드 설치했다는 것을  증명하며, 이 일을 나타내므로 일부 종류의 시빌 공격을 예방할수 있습니다. 공급자가 사용자에게 쓰레기 결과를 제공하는 경우 사용자는 [Fail]과 함께[milliseconds]를 라우터로 다시 보낼수 있으며, 공급자는 해당 컴퓨팅 작업에 대한 보상을 받지 못합니다.

* RFC를 통한 네트워크 홍수 시빌 공격은 AccessRate를 통해 방지됩니다. 
RFC 비용 = MOR토큰비용/RFC 수(RFC를 보내는 "비용"은 해당 RFC를 대신 제출하는데 사용된 MOR토큰 획득 비용을 제출된 RFC 수로 나눈 값입니다.) 따라서 비용은 0이 아니지만 사용자는 RFC가 발생될때마다 손해를 본다고 느끼지 않습니다.

* 통과/실패 여부는 사용자에 의해 결정되며 어느정도 품질이 보장됩니다. 사용자는 통과/실패 여부를[milliseconds] 와 함께 라우터로 다시 전달합니다. 만약 불합격일 경우 보상이 없거나 벌점이 부여됩니다(곧 결정 예정). 공급자를 부당하게 실패시키는 것에 대한 동기부여가 없습니다(금전적 동기부여가 없음). 이 메커니즘은 공급자가 빠르기만 한 쓸모없는 결과를 제공하는것을 방지합니다.
고려사항: 아마도 사용자 MOR > 공급자 MOR인 경우에만 실패시 보상이 없을 것입니다. 그렇지 않으면 라우터가 사회적 논리화 에서 사용할 수 있는 부정적인 점수만 있을 것입니다.
* 모든 4개의 당사자(사용자, 공급자, 라우터, 컴퓨팅 컨트랙트)는 모두 고유한  MOR 주소를 신분증(ID)으로 가지고 있습니다. 당사자 사이의 모든 메시지는 서명이 필요합니다(하지만 대부분의 경우 블록체인 트랜젝션이 필요하지 않음) 

* 공급자는 시빌 공격을 방지하기 위해 0이상의 잔액을 보유해야 합니다.

* [milisecond] 의 기준이 높을수록 네트워크는 일반적으로 빨라집니다. 하지만 소규모 공급자에게 권장하지 않습니다.

* 느린 결과를 공급하는것에 동기부여가 없습니다.(계산 후 수익 없음)
