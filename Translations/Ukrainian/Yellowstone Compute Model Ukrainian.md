![Image1forYellowstone](https://github.com/MorpheusAIs/Morpheus/assets/1563345/80a6c1cf-fe52-42ba-bfd4-91d9faf67f07)

# Модель Обчислень Морфеус "Yellowstone"
### Erik Voorhees
### 3 січня 2024

Запропонована редакція структури токеноміки Morpheus для стимулювання обчислень у децентралізованій мережі ШІ.

## Короткий зміст
У моделі обчислень Yellowstone мережа Morpheus виплачує провайдерам винагороду лише за фактично надані обчислювальні потужності через конкурентний процес торгів, а також виділяє обмежений випуск IPS (прим. одиниця виміру запитів до ШІ) пропорційно до кількості утримуваних токенів MOR, а не на основі платежів. Це істотно покращує досвід користувача, мінімізуючи при цьому вразливість до атак типу Sybil. Yellowstone також вводить важливі метрики часу та проходження тесту "Pass/Fail", щоб гарантувати, що постачальники обчислень діють досить оперативно та точно. Yellowstone зберігає конфіденційність, не спрямовуючи запити або результати через маршрутизатор, та мінімізує транзакції в блокчейні для забезпечення масштабованості. За допомогою цієї моделі MOR набуває фундаментальної цінності, надаючи постійний (але обмежений) доступ до обчислень без необхідності проведення транзакцій на кожну операцію виведення.

Якщо ця пропозиція буде прийнята, вона замінить розділ "Compute Proof, Registration & Reward" у білій книзі [Morpheus](https://github.com/MorpheusAIs/Docs/blob/main/Translations/Ukrainian/Whitepaper%20Ukrainian.md)

## Контекст
Morpheus використовує токеноміку для стимулювання надання достатнього та масштабованого обчислювального ресурсу для децентралізованого та необмеженого генеративного ШІ. У початковій концепції Morpheus виділяв 24% емісії MOR безпосередньо провайдерам (постачальникам) обчислювальних потужностей, пропорційно отриманим запитам, і віддавав пріоритет у запитах провайдерам, у яких було більше MOR.

### З оригінальної білої книги:
`MOR-комісії за транзакції, що спалюються кожним провайдером обчислень, є доказом його статусу і приносять йому пропорційну частку токенів MOR щодня.`

`Наприклад, якщо існує 100 провайдерів обчислень у день запуску мережі, то кожен із них отримає пропорційну винагороду залежно від кількості MOR, яку він спалив через комісії. У даному випадку, припустимо, що кожен із 100 провайдерів обчислень спалив 100 MOR, тоді 1% з 3456 MOR щодня = 34.56 MOR".`

### Однак цей підхід має три основні проблеми:
1) Він вимагає від користувачів оплати комісії за кожну операцію виведення. Навіть якщо це дешево, це суттєва перешкода, яка викликає поганий користувальницький досвід і постійне відставання від OpenAI. Крім того, потрібно щонайменше одна транзакція в блокчейні на кожну операцію, що, ймовірно, не зможе масштабуватися навіть на L2. Кожна операція має надзвичайно низьку вартість і якщо буде потрібна транзакція в блокчейні, то операції стануть економічно недоцільними.
2) Ця модель суттєво схильна до вразливостей, тому що очікувані доходи для постачальників обчислень набагато вищі за фактичні витрати на обчислення. Таким чином, зловмисник може засипати свій власний вузол провайдера запитами на операції, заробляючи відносно більшу частину MOR токенів щодня, навіть якщо жодної економічної цінності нікому не надано. Це, ймовірно, призведе до великих обсягів обчислень, що не використовуються, які зникнуть, як тільки зникне величезна можливість доходу, а витрачені за цей період MOR будуть втрачені.
3) Якщо запити на операції виводу розподіляються залежно від кількості MOR, що утримується провайдерами обчислень, то мережа ігнорує продуктивність цих постачальників (час відгуку) та вартість їхньої обчислювальної обробки. Саме ці два фактори мережа має намагатися оптимізувати (час відгуку та вартість обчислень мають прагнути бути мінімальними). Якщо провайдер з найбільшою кількістю MOR використовує GPU за 200 доларів, випущену, коли він ще навчався в коледжі, продуктивність операцій для багатьох користувачів буде надзвичайно низькою. Пріоритет повинен базуватися на ціні пропозиції обчислень та продуктивності, а не кількості утримуваних MOR.

Нижче представлена модель "Yellowstone", яка модифікує токеноміку Morpheus для надання обчислювальних ресурсів, щоб вирішити зазначені вище проблеми. Ця модель працює незалежно від того, яка частина емісії виділена на обчислення, і ми припускатимемо збереження поточного статусу, де 24% загальної емісії виділено на обчислення.


### Цілі:
1) Дозволити користувачам не платити за кожну операцію виведення (в ідеалі взагалі не платити).
2) Досягти ефективного, масштабованого та сталого надання обчислювальних ресурсів без переплати.
3) Стимулювати конкуренцію за часом відгуку та вартості серед постачальників обчислювальних ресурсів.
4) Мінімізувати кількість блокчейн-транзакцій (чи то L2 чи інші).
5) Продемонструвати економічно обґрунтований фундаментальний попит на MOR.

## Модель Yellowstone
Включає чотири компоненти:

### Користувачі
- Мають запити
- Хочуть швидких та точних обчислень безкоштовно та без цензури/спостереження
  
### Провайдери
- Мають обчислювальні ресурси
- Хочуть грошей (MOR)

### Маршрутизатор
- Має високу пропускну здатність
- Децентралізований

### Контракт обчислень
- Загальнодоступний смарт-контракт, який отримує емісію MOR, відстежує нарахування та утримання у постачальників та виплачує їм нагороди під час виклику.


## Стандартні ваги та виміри
В ШІ є атомна одиниця операцій виведень, що вимірюється у виведеннях у секунду (inferences/second IPS). Це можна концептуально порівняти з WEI на блокчейні. Виведення використовуються для визначення тарифів у маршрутизаторі Yellowstone. Отже, вага однієї одиниці штучного інтелекту Morpheus, є виведення. Залежно від типу запиту, це може бути застосовано до будь-якої обчислювальної задачі.

У міру злиття ШІ та блокчейну, Morpheus прагне надати відкритий стандарт вимірювань, щоб уточнити термінологію, що використовується як ШІ, так і блокчейном.

Існує два типи запитів, визначених розміром відповіді, що повертається моделлю:

**Запити з певною довжиною**, де відповідь враховує довжину відповіді, що повертається. Приклади включають:
- Чат/Створення зображення
- Діагностика хвороб
- Розпізнавання об'єктів
- Виявлення шахрайства

**Запити з невизначеною довжиною** вимагають ресурсів для відповіді, які можна дізнатися лише після створення відповіді. Приклади таких запитів:
- Заспівай сонату про спагетті
- Створи відеопривітання З днем народження
- Сумісні модель X з моделлю Y
- Розріж 3D-модель у файл .stl

Yellowstone фокусується на запитах із певною довжиною. Описаний маршрутизатор буде побудований так, щоб у майбутньому обробляти також запити з невизначеною довжиною, але не для обслуговування їх сьогодні. Для цього ми використовуємо стандартизоване вимірювання децентралізованого ШІ (DeAI).

## Тарифи децентралізованого ШІ

### Вирази виводу за секунду:

| Тип | Відповідь | Тариф |
|------|----------|------|
| Визначений | Мова | Виведені Токени за секунду (TPS) |
| Невизначений – медіа | Аудіо | Виведені зразки за секунду (ISPS) |
| Невизначений – медіа | Відео | Виведені кадри за секунду (IFPS) |
| Невизначений – майбутні технології | Невідомий майбутній формат Н/Д |

Перша одиниця вимірювання операцій виведення для маршрутизатора Yellowstone це TPS (виведені токени за секунду).  Інші формати будуть представлені у подальшому.

### Час

Час блоку для виведення становить 12 секунд, що означає, що блок виведення транзакцій публікується та враховується 5 разів на хвилину.

## Дефініції

**"Користувачі"**: визначені як будь-який учасник, у якого є адреса MOR і який надсилає запити маршрутизатору на використання обчислень. Це може бути конкретна особа, яка надсилає запити з локальної версії Morpheus, або це може бути бот, або це може бути компанія або веб-сайт від третьої сторони, який взаємодіє з мережею Morpheus від імені своїх кінцевих користувачів (маються на увазі кінцеві користувачі тертьої сторони, які не мають відношення до визначення користувачів вище).

**"Постачальники"**: визначені як будь-який учасник, який підтримує роботу вузла який надає ресурси для обчислень, що має адресу MOR і пропонує ставки на IPS через маршрутизатор. Коли постачальник виграє ставку, він надає ресурси для обчислень (графічні процесори і т.д.) для запитуваних моделей ШІ.

**"Маршрутизатор"**: визначений як програмний додаток, що має адресу MOR і є посередником між користувачами та постачальниками на двосторонньому ринку. Маршрутизатор реєструє та відстежує адреси та ставки постачальників, обробляє запити від користувачів, записує [мілісекунди] результати тестів Pass/Fail оброблених запитів та вказує контракту обчислень нараховувати кошти (MOR) у міру потреби постачальникам. Маршрутизатор ніколи не відправляє і не отримує транзакції MOR (або транзакції на будь-якому блокчейні) і ніколи не бачить вмісту запиту або відповіді.

**"Контракт обчислень**": визначений як смарт-контракт, що має адресу MOR, який отримує всю емісію MOR виділену для обчислень, відстежує суми, які мають бути виплачені постачальникам, та виплачує MOR постачальникам за запитом.

**"Виведення у секунду (IPS)**: це атомна одиниця вимірів операцій виведення в ШІ, яка використовується Маршрутизатором для визначення поточної вартості.

**"IPSMax"** відноситься до максимальної кількості токенів, що приймаються для оплати маршрутизатором.

**"RFC"** означає "Запит на обчислення". Користувач відправляє RFC маршрутизатору і вказує [LLM], до якої користувач хоче отримати доступ, а також [IPSMax], який є межею прийнятних IPS у відповіді. Користувачеві слід обмежувати цю кількість, тому що більш високі числа = довше очікування відповідей і вважаються великим вкладом у [UserMax], який обмежений щодня.

### Стимул для ініціалізації обчислень

Протягом першого року після завершення 90 денного періоду ініціалізації, топ-100 постачальників обчислень можуть мати право на пропорційну частину у розмірі 2,4% від емісії MOR. Це розраховується маршрутизатором та враховується у контракті обчислень.

## Процес роботи
1) Користувачі, Постачальники та Маршрутизатор створюють публічні ключі MOR (це їхній ідентифікатор та підпис для всіх повідомлень).
2) Якщо Користувач має позитивний баланс MOR, Користувач може надіслати підписане повідомлення із запитом на обробку "RFC" Маршрутизатору. Користувач вказує [LLM] та [IPSMax].
3) Маршрутизатор упорядковує запити на обробку на основі балансу MOR Користувача (вирішує проблему сибілу).
4) Маршрутизатор вибирає Постачальника, що підтримує [LLM], з пріоритетом найменшої ставки IPS в MOR.
5) Маршрутизатор відправляє перевірку активності Постачальнику. Якщо перевірку пройдено, то
6) Маршрутизатор з'єднує Користувача з Постачальником через TCP/IP.
7) Користувач надсилає запит ([LLM], [запит]) Постачальнику.
8) Постачальник обчислює запит, надсилає результат Користувачеві.
9) Користувач повідомляє метрики Маршрутизатору (наприклад, кількість IPS, час, результат тесту Пройдено/Не пройдено).
10) Маршрутизатор інструктує Контракт Обчислень нарахувати Постачальнику MOR, якщо робота була виконана задовільно.
11) (Через деякий час) Постачальник запитує виплату MOR з Контракту Обчислень, який надсилає виплату MOR, якщо вона дійсна.

![ComputeContractImage2](https://github.com/MorpheusAIs/Morpheus/assets/1563345/e66ea20c-9851-4f9e-9caa-66c6d798c462)

## Результат
* Користувач отримав швидкий результат для свого запиту і не заплатив нічого (це призведе до дивовижного досвіду користувача і, отже, до широкого прийняття). **Вирішується Мета 1.**
* Контракт Обчислень оплачує обчислення через конкурентний процес ставок та перевірку якості/задоволеності від Користувача, який їх замовив. **Вирішується Мета 2.**
* Постачальник отримує гроші (MOR) від Контракту Обчислень, за умови досить швидкої відповіді. Постачальник отримує рівно те, що просив за надання обчислень. Якщо ставка постачальника надто висока, інші будуть робити нижчі ставки, таким чином система ефективна і знижуватиме ціни постачальників до вартості базової електроенергії. **Вирішується Мета 3**
* Кількість онлайн-транзакцій було мінімізовано (багато запитів може проходити за допомогою декількох блокчейн-транзакції). **Вирішується Мета 4**
* Можливість отримати швидке, безкоштовне обчислення стимулює попит на токени MOR серед користувачів. **Вирішується Мета 5**
* Кроки 6 і 7 забезпечують розумну конфіденційність (запит ніколи не стосується маршрутизатора, як і результат). Постачальники вибираються відносно випадковим чином і ніколи не знають особу Користувача, крім IP-адреси. Вищий рівень конфіденційності може бути досягнутий пізніше з використанням TOR та/або FHE.
* Баланс MOR було зменшено з Контракту Обчислень. Контракт буде платоспроможним, поки сплачений MOR < заробленого MOR за період від емісії.
* Якщо користувач надсилає RFC, що перевищує UserMax Користувача, Маршрутизатор відхиляє запит.

-------------

## Бюджет обчислень
Мережі Morpheus необхідно визначити, скільки MOR вона готова витратити на обчислення у певний період (наприклад, щодня). Це називається Бюджетом обчислень. Кожен період Контракт Обчислень може витрачати не більше цієї кількості MOR. Це число, помножене на ціну MOR, дає нам бюджет у доларах на придбання обчислень щодня.

**Бюджет на обчислення** = 1% балансу MOR контракту обчислень на кінець попереднього дня.

* Оскільки бюджет є фіксованим відсотком від пулу, він ніколи не вичерпається (він може лише асимптотично убувати).
* Більше того, тому що в реальних умовах жоден MOR ніколи не буде використовувати свою максимальну потужність кожен день, це означає, що на практиці бюджет ніколи не досягне своєї межі в 1% від балансу попереднього дня контракту на обчислення. Це вірно, поки хоча б один MOR залишається бездіяльним у гаманці або на біржі.

## Рівень доступу (AccessRate)
Мережа Morpheus розподіляє дефіцитний ресурс виробництва IPS через концепцію "AccessRate" (Рівень доступу). AccessRate визначає, скільки IPS кожен токен MOR може використати на день. Невикористаний доступ не накопичується. AccessRate завжди відображається як кількість IPS на 1 токен MOR (наприклад, 1 MOR = 15000 IPS). AccessRate визначається частково за допомогою MaxIPS, який кількісно оцінює максимальну кількість IPS, яку мережа може закупити на день.
  
**MaxIPS** = ((Бюджет обчислень MOR * Ціна MOR) / Ціна IPS) * 1000  
**AccessRate** = (1/Загальна кількість MOR) * MaxIPS  
**UserMax** = MaxIPS * Баланс MOR користувача  

### Приклад показників:
**Загальна кількість MOR** = 10,000,000 MOR   
**Баланс контракту обчислень на кінець попереднього дня** = 300,000 MOR  
**Бюджет обчислень MOR** = 3,000 MOR на день  (1% від попереднього показника)  
**Ціна MOR** = $20  
**Ціна IPS** = $0.002 за 1000 IPS    
**Баланс MOR користувача** = 5 MOR tokens  

### Приклад результату:
**MaxIPS** = 30,000,000,000 IPS (максимум IPS, який мережі може придбати/виробити на день)  
**AccessRate** = 3,000 (отже, кожен токен MOR надає доступ до 3,000 IPS на день)  
**UserMax** = 15,000 (користувач з балансом 5 MOR може отримати доступ до 15,000 IPS на день)

- Кожен період (щодня) Morpheus, як мережа, має в своєму розпорядженні достатні кошти для купівлі X кількості IPS (обчислень) у постачальників обчислень. X є функцією кількості MOR, яку Контракт Обчислень готовий витратити («Бюджет обчислень»), помноженої на поточну ціну MOR та поділеної на ринкову вартість IPS.
- Якщо Бюджет обчислень складає 3,000 MOR, і кожен MOR коштує $20, то мережа може купити (виконати) обчислення на суму до $60,000 цього дня. Якщо поточна ставка за 1,000 IPS складає $0.002, то мережа може купити до 30 мільярдів IPS (30 мільйонів помножених на 1000 IPS).
- Цей потенційний обсяг виробництва 30 мільярдів IPS розподіляється пропорційно балансу MOR. Припустимо, що у обігу перебуває 10,000,000 MOR. Користувач із 500 токенами MOR (0.005% від загального) може вільно використовувати до 1,5 мільйона IPS цього дня.
- Поки Бюджет обчислень вставновлений у формі відсотка від балансу Контракту Обчислень, він не може вичерпати запаси MOR.
- На практиці більшість токенів будуть перебувати в гаманцях та біржах, і лише невелика частина буде використовуватися для запиту виробництва IPS.

## Нотатки
1) Основою попиту на MOR є бажання користувачів отримати доступ до генеративного ШІ та інших форм обчислень у мережі Morpheus "безкоштовно". Чим більше токенів MOR утримуэ Користувач, тим до більшої кількості "безкоштовних" обчислень він отримує доступ.
 
2) Тип обладнання постачальника не має значення для мережі, доки відповідає умовам Pass/Fail тесту. Будь-який Постачальник, який робитиме ставки на більшу кількість запитів, ніж він може ефективно обробляти, буде покараний провалом (Fail) цього тесту (обчислення не будуть сплачені).

3) Наведена вище модель важлива тим, що виплачує винагороду Постачальникам ТІЛЬКИ за наявності попиту їх обчислення. Це запобігає ситуації, коли великі обсяги MOR емітуються передчасно, коли мережі це не потрібно.

4) Постачальникам слід довести, що вони мають певну LLM, підписуючи хеш моделі LLM своїм ключем. Це не доводить, що вони використовували модель, але це доводить, що вони завантажили і встановили LLM, що являє собою роботу і тим самим запобігає деяким формам сибіл шахрайства. Якщо Постачальники надають Користувачеві некоректні результати, Користувач може відправити [Fail] разом з [мілісекундами] назад маршрутизатору, і Постачальнику не буде нараховано винагороду за це обчислення. Morpheus не потрібно, щоб всі відповіді були ідеальними... йому просто потрібно достатньо хороших відповідей порівняно з альтернативами, що конкурують.

5) Сибіл-атаки, пов'язані зі спамом мережі запитами на обчислення (RFC), запобігають за допомогою AccessRate. "Вартість" відправки RFC - це вартість придбання токена MOR, поділена на кількість RFC, відправлених від його імені. Вартість ніколи не дорівнює нулю, але користувач не відчує шкоди при кожному створенні RFC.Це здаватиметься несуттєвим для всіх реальних користувачів та надзвичайно дорогим для спамерів. Фактично, подібно комісіям у біткоїні, Morpheus може вважати всі RFC дійсними і не дбати про різницю між спамом і "справжніми".

6) Результат Pass/Fail визначається Користувачем і певною мірою контролює якість. Користувач передає результат [Проходження/Провалу] разом з [мілісекундами] назад у маршрутизатор. У разі провалу (Fail) або немає винагороди, або штрафні бали (підлягає обговоренню). Користувач не має стимулу навмисно відхиляти (Fail) результат обчислень Постачальника (немає грошового стимулу до цього). З іншого боку, цей механізм запобігає надсиланню швидких, але марних результатів Постачальниками.  
До розгляду: можливо, відсутність винагороди під час провалу лише у випадку, якщо MOR користувача > MOR постачальника. В іншому випадку просто негативний бал, який маршрутизатор може використовувати у своїй логіці.

7) Усі чотири сторони (Користувач, Постачальник, Маршрутизатор і Контракт Обчислень) мають унікальну адресу MOR як свій ідентифікатор. Усі повідомлення між сторонами вимагають підписів (але більшість із них не потребує блокчейн транзакцій).

8) У Постачальників повинен бути ненульовий баланс, щоб запобігти сибіл атаки з боку Постачальника.

9) Якщо критерії [мілісекунд] вищі, мережа буде загалом швидше, але відлякуючи дрібніших Постачальників.

10) Існують негативні стимули до надання повільних результатів (немає доходу після обчислень).
